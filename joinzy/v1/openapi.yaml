openapi: "3.0.3"
info:
  title: Joinzy MVP API
  version: "1.0.0"
servers:
  - url: https://api.joinzy.app/v1
security:
  - bearerAuth: []

paths:
  /auth/email/request-otp:
    post:
      security: []
      operationId: requestEmailOtp
      summary: "Запросить OTP по email"
      description: "Отправляет одноразовый пароль (OTP) на указанный email для аутентификации."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
              required: [email]
      responses:
        "200":
          description: OTP отправлен успешно
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                example:
                  message: "OTP отправлен на указанный email"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "429":
          $ref: "./shared/responses.yaml#/TooManyRequests"

  /auth/email/verify-otp:
    post:
      security: []
      operationId: verifyEmailOtp
      summary: "Проверить OTP по email"
      description: "Проверяет одноразовый пароль (OTP) и возвращает JWT токен при успешной аутентификации."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                otp:
                  type: string
                  example: "123456"
              required: [email, otp]
      responses:
        "200":
          description: Успешная аутентификация
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                  refreshToken:
                    type: string
              examples:
                authTokens:
                  value:
                    accessToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                    refreshToken: "dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4="
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /auth/password/login:
    post:
      security: []
      operationId: loginWithPassword
      summary: "Вход с паролем"
      description: "Аутентификация пользователя с помощью email и пароля."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
              required: [email, password]
      responses:
        "200":
          description: Успешный вход
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                  refreshToken:
                    type: string
              examples:
                passwordLogin:
                  value:
                    accessToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                    refreshToken: "dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4="
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /auth/token/refresh:
    post:
      security: []
      operationId: refreshToken
      summary: "Обновить токен"
      description: "Обновляет JWT access token используя refresh token."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                refreshToken:
                  type: string
              required: [refreshToken]
      responses:
        "200":
          description: Токен обновлен
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                  refreshToken:
                    type: string
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /auth/me:
    get:
      operationId: getCurrentUser
      summary: "Получить текущего пользователя"
      description: "Возвращает информацию о текущем аутентифицированном пользователе."
      responses:
        "200":
          description: Информация о пользователе
          content:
            application/json:
              schema:
                $ref: "./models/User.yaml#/User"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /auth/logout:
    post:
      operationId: logoutUser
      summary: "Выйти из системы"
      description: "Завершает сессию пользователя и инвалидирует токены."
      responses:
        "204":
          description: Успешный выход
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /events:
    get:
      operationId: getEvents
      summary: "Получить список событий"
      description: "Возвращает список событий с фильтрами и пагинацией."
      parameters:
        - $ref: "./shared/parameters.yaml#/q"
        - $ref: "./shared/parameters.yaml#/city"
        - $ref: "./shared/parameters.yaml#/categoryId"
        - $ref: "./shared/parameters.yaml#/startFrom"
        - $ref: "./shared/parameters.yaml#/startTo"
        - $ref: "./shared/parameters.yaml#/priceMin"
        - $ref: "./shared/parameters.yaml#/priceMax"
        - $ref: "./shared/parameters.yaml#/isFree"
        - $ref: "./shared/parameters.yaml#/language"
        - $ref: "./shared/parameters.yaml#/sort"
        - $ref: "./shared/parameters.yaml#/limit"
        - $ref: "./shared/parameters.yaml#/cursor"
      responses:
        "200":
          description: Список событий
          content:
            application/json:
              schema:
                $ref: "./models/PaginatedEvents.yaml#/PaginatedEvents"
              examples:
                listEvents:
                  value:
                    items:
                      - id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                        title: "Концерт классической музыки"
                        city: "Москва"
                        startAt: "2024-07-01T19:00:00Z"
                        price: 1500.0
                        isFree: false
                        language: "ru"
                    meta:
                      nextCursor: "eyJpZCI6IjNmYTg1ZjY0In0="
                      total: 123
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

    post:
      operationId: createEvent
      summary: "Создать событие"
      description: "Создает новое событие (только для организаторов)."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "./models/Event.yaml#/Event"
      responses:
        "201":
          description: Событие создано
          content:
            application/json:
              schema:
                $ref: "./models/Event.yaml#/Event"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"

  /events/{eventId}:
    get:
      operationId: getEventById
      summary: "Получить событие по ID"
      description: "Возвращает информацию о событии по UUID."
      parameters:
        - $ref: "./shared/parameters.yaml#/eventId"
      responses:
        "200":
          description: Информация о событии
          content:
            application/json:
              schema:
                $ref: "./models/Event.yaml#/Event"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

    patch:
      operationId: updateEvent
      summary: "Обновить событие"
      description: "Обновляет данные события (только для организаторов)."
      parameters:
        - $ref: "./shared/parameters.yaml#/eventId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "./models/Event.yaml#/Event"
      responses:
        "200":
          description: Событие обновлено
          content:
            application/json:
              schema:
                $ref: "./models/Event.yaml#/Event"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /events/{eventId}/publish:
    post:
      operationId: publishEvent
      summary: "Опубликовать событие"
      description: "Публикует событие, делая его видимым для пользователей (только для организаторов)."
      parameters:
        - $ref: "./shared/parameters.yaml#/eventId"
      responses:
        "204":
          description: Событие опубликовано
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /events/{eventId}/cancel:
    post:
      operationId: cancelEvent
      summary: "Отменить событие"
      description: "Отменяет событие (только для организаторов). При отмене события возврат 100%."
      parameters:
        - $ref: "./shared/parameters.yaml#/eventId"
      responses:
        "204":
          description: Событие отменено
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /events/{eventId}/attendees:
    get:
      operationId: getEventAttendees
      summary: "Получить список участников события"
      description: "Возвращает список участников события с пагинацией."
      parameters:
        - $ref: "./shared/parameters.yaml#/eventId"
        - $ref: "./shared/parameters.yaml#/limit"
        - $ref: "./shared/parameters.yaml#/cursor"
      responses:
        "200":
          description: Список участников
          content:
            application/json:
              schema:
                $ref: "./models/PaginatedUsers.yaml#/PaginatedUsers"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /events/{eventId}/attendees/{ticketId}/check-in:
    post:
      operationId: checkInAttendee
      summary: "Отметить участника на событии"
      description: "Отмечает участника с указанным ticketId на событии (только для организаторов)."
      parameters:
        - $ref: "./shared/parameters.yaml#/eventId"
        - $ref: "./shared/parameters.yaml#/ticketId"
      responses:
        "204":
          description: Участник отмечен
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /orders:
    get:
      operationId: getOrders
      summary: "Получить список заказов"
      description: "Возвращает список заказов пользователя с пагинацией."
      parameters:
        - $ref: "./shared/parameters.yaml#/limit"
        - $ref: "./shared/parameters.yaml#/cursor"
      responses:
        "200":
          description: Список заказов
          content:
            application/json:
              schema:
                $ref: "./models/PaginatedOrders.yaml#/PaginatedOrders"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

    post:
      operationId: createOrder
      summary: "Создать заказ"
      description: "Создает заказ на билеты. Требуется заголовок Idempotency-Key."
      parameters:
        - $ref: "./shared/parameters.yaml#/idempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "./models/Order.yaml#/Order"
      responses:
        "201":
          description: Заказ создан, инициализация оплаты
          content:
            application/json:
              schema:
                type: object
                properties:
                  order:
                    $ref: "./models/Order.yaml#/Order"
                  paymentUrl:
                    type: string
                    format: uri
              example:
                order:
                  id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                  status: "pending"
                  totalAmount: 2500.0
                paymentUrl: "https://yookassa.ru/pay/123456"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "409":
          $ref: "./shared/responses.yaml#/Conflict"

  /orders/guest:
    post:
      security: []
      operationId: createGuestOrder
      summary: "Создать заказ гостя"
      description: "Создает заказ на билеты для гостя. Требуется заголовок Idempotency-Key."
      parameters:
        - $ref: "./shared/parameters.yaml#/idempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "./models/Order.yaml#/Order"
      responses:
        "201":
          description: Заказ гостя создан, инициализация оплаты
          content:
            application/json:
              schema:
                type: object
                properties:
                  order:
                    $ref: "./models/Order.yaml#/Order"
                  paymentUrl:
                    type: string
                    format: uri
              example:
                order:
                  id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                  status: "pending"
                  totalAmount: 2500.0
                paymentUrl: "https://yookassa.ru/pay/123456"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "409":
          $ref: "./shared/responses.yaml#/Conflict"

  /orders/{orderId}:
    get:
      operationId: getOrderById
      summary: "Получить заказ по ID"
      description: "Возвращает информацию о заказе по UUID."
      parameters:
        - $ref: "./shared/parameters.yaml#/orderId"
      responses:
        "200":
          description: Информация о заказе
          content:
            application/json:
              schema:
                $ref: "./models/Order.yaml#/Order"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /tickets:
    get:
      operationId: getTickets
      summary: "Получить список билетов"
      description: "Возвращает список билетов пользователя с пагинацией."
      parameters:
        - $ref: "./shared/parameters.yaml#/limit"
        - $ref: "./shared/parameters.yaml#/cursor"
      responses:
        "200":
          description: Список билетов
          content:
            application/json:
              schema:
                $ref: "./models/PaginatedTickets.yaml#/PaginatedTickets"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /tickets/{ticketId}:
    get:
      operationId: getTicketById
      summary: "Получить билет по ID"
      description: "Возвращает информацию о билете по UUID."
      parameters:
        - $ref: "./shared/parameters.yaml#/ticketId"
      responses:
        "200":
          description: Информация о билете
          content:
            application/json:
              schema:
                $ref: "./models/Ticket.yaml#/Ticket"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /tickets/{ticketId}/refund-request:
    post:
      operationId: requestTicketRefund
      summary: "Запросить возврат билета"
      description: "Запрашивает возврат билета согласно правилам возврата."
      parameters:
        - $ref: "./shared/parameters.yaml#/ticketId"
      responses:
        "204":
          description: Запрос на возврат принят
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /webhooks/yookassa:
    post:
      security: []
      operationId: yookassaWebhook
      summary: "Вебхук YooKassa"
      description: "Обрабатывает уведомления от YooKassa (публичный endpoint). Правила возврата: 100% если >=72ч, 50% если >=24ч, 0% если <24ч."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                event:
                  type: string
                object:
                  type: object
              example:
                event: "payment.succeeded"
                object:
                  id: "1234567890"
                  status: "succeeded"
      responses:
        "200":
          description: Вебхук обработан

  /clubs:
    get:
      operationId: getClubs
      summary: "Получить список клубов"
      description: "Возвращает список клубов с пагинацией."
      parameters:
        - $ref: "./shared/parameters.yaml#/limit"
        - $ref: "./shared/parameters.yaml#/cursor"
      responses:
        "200":
          description: Список клубов
          content:
            application/json:
              schema:
                $ref: "./models/PaginatedClubs.yaml#/PaginatedClubs"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

    post:
      operationId: createClub
      summary: "Создать клуб"
      description: "Создает новый клуб (только для организаторов)."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "./models/Club.yaml#/Club"
      responses:
        "201":
          description: Клуб создан
          content:
            application/json:
              schema:
                $ref: "./models/Club.yaml#/Club"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"

  /clubs/{clubId}:
    get:
      operationId: getClubById
      summary: "Получить клуб по ID"
      description: "Возвращает информацию о клубе по UUID."
      parameters:
        - $ref: "./shared/parameters.yaml#/clubId"
      responses:
        "200":
          description: Информация о клубе
          content:
            application/json:
              schema:
                $ref: "./models/Club.yaml#/Club"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

    patch:
      operationId: updateClub
      summary: "Обновить клуб"
      description: "Обновляет данные клуба (только для организаторов)."
      parameters:
        - $ref: "./shared/parameters.yaml#/clubId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "./models/Club.yaml#/Club"
      responses:
        "200":
          description: Клуб обновлен
          content:
            application/json:
              schema:
                $ref: "./models/Club.yaml#/Club"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

    delete:
      operationId: deleteClub
      summary: "Удалить клуб"
      description: "Удаляет клуб (только для организаторов)."
      parameters:
        - $ref: "./shared/parameters.yaml#/clubId"
      responses:
        "204":
          description: Клуб удален
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /clubs/{clubId}/follow:
    post:
      operationId: followClub
      summary: "Подписаться на клуб"
      description: "Подписка на клуб по UUID."
      parameters:
        - $ref: "./shared/parameters.yaml#/clubId"
      responses:
        "204":
          description: Подписка выполнена
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"
    delete:
      operationId: unfollowClub
      summary: "Отписаться от клуба"
      description: "Отписка от клуба по UUID."
      parameters:
        - $ref: "./shared/parameters.yaml#/clubId"
      responses:
        "204":
          description: Отписка выполнена
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /feed:
    get:
      operationId: getFeed
      summary: "Получить ленту"
      description: "Возвращает ленту постов с пагинацией."
      parameters:
        - $ref: "./shared/parameters.yaml#/limit"
        - $ref: "./shared/parameters.yaml#/cursor"
      responses:
        "200":
          description: Лента постов
          content:
            application/json:
              schema:
                $ref: "./models/PaginatedPosts.yaml#/PaginatedPosts"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /posts:
    post:
      operationId: createPost
      summary: "Создать пост"
      description: "Создает новый пост. Ограничение: 10 постов/мин (429 при превышении)."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "./models/Post.yaml#/Post"
      responses:
        "201":
          description: Пост создан
          content:
            application/json:
              schema:
                $ref: "./models/Post.yaml#/Post"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "429":
          $ref: "./shared/responses.yaml#/TooManyRequests"

  /posts/{postId}:
    get:
      operationId: getPostById
      summary: "Получить пост по ID"
      description: "Возвращает пост по UUID."
      parameters:
        - $ref: "./shared/parameters.yaml#/postId"
      responses:
        "200":
          description: Пост
          content:
            application/json:
              schema:
                $ref: "./models/Post.yaml#/Post"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

    patch:
      operationId: updatePost
      summary: "Обновить пост"
      description: "Обновляет пост по UUID."
      parameters:
        - $ref: "./shared/parameters.yaml#/postId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "./models/Post.yaml#/Post"
      responses:
        "200":
          description: Пост обновлен
          content:
            application/json:
              schema:
                $ref: "./models/Post.yaml#/Post"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

    delete:
      operationId: deletePost
      summary: "Удалить пост"
      description: "Удаляет пост по UUID."
      parameters:
        - $ref: "./shared/parameters.yaml#/postId"
      responses:
        "204":
          description: Пост удален
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /posts/{postId}/like:
    post:
      operationId: likePost
      summary: "Поставить лайк посту"
      description: "Добавляет лайк к посту."
      parameters:
        - $ref: "./shared/parameters.yaml#/postId"
      responses:
        "204":
          description: Лайк добавлен
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"
    delete:
      operationId: unlikePost
      summary: "Убрать лайк с поста"
      description: "Убирает лайк с поста."
      parameters:
        - $ref: "./shared/parameters.yaml#/postId"
      responses:
        "204":
          description: Лайк удален
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /posts/{postId}/comments:
    get:
      operationId: getPostComments
      summary: "Получить комментарии поста"
      description: "Возвращает список комментариев к посту с пагинацией."
      parameters:
        - $ref: "./shared/parameters.yaml#/postId"
        - $ref: "./shared/parameters.yaml#/limit"
        - $ref: "./shared/parameters.yaml#/cursor"
      responses:
        "200":
          description: Список комментариев
          content:
            application/json:
              schema:
                $ref: "./models/PaginatedComments.yaml#/PaginatedComments"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

    post:
      operationId: createPostComment
      summary: "Создать комментарий к посту"
      description: "Добавляет комментарий к посту."
      parameters:
        - $ref: "./shared/parameters.yaml#/postId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "./models/Comment.yaml#/Comment"
      responses:
        "201":
          description: Комментарий создан
          content:
            application/json:
              schema:
                $ref: "./models/Comment.yaml#/Comment"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /chats:
    get:
      operationId: getChats
      summary: "Получить список чатов"
      description: "Возвращает список чатов пользователя."
      responses:
        "200":
          description: Список чатов
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "./models/Chat.yaml#/Chat"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /chats/{chatId}:
    get:
      operationId: getChatById
      summary: "Получить чат по ID"
      description: "Возвращает информацию о чате по UUID. (event_chat доступен только при наличии билета)"
      parameters:
        - $ref: "./shared/parameters.yaml#/chatId"
      responses:
        "200":
          description: Информация о чате
          content:
            application/json:
              schema:
                $ref: "./models/Chat.yaml#/Chat"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /chats/{chatId}/messages:
    get:
      operationId: getChatMessages
      summary: "Получить сообщения чата"
      description: "Возвращает сообщения чата с пагинацией и фильтрацией по afterMessageId."
      parameters:
        - $ref: "./shared/parameters.yaml#/chatId"
        - $ref: "./shared/parameters.yaml#/afterMessageId"
        - $ref: "./shared/parameters.yaml#/limit"
      responses:
        "200":
          description: Сообщения чата
          content:
            application/json:
              schema:
                $ref: "./models/PaginatedMessages.yaml#/PaginatedMessages"
              examples:
                chatPollingResponse:
                  value:
                    items:
                      - id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                        chatId: "1c6b147e-3f3a-4a1a-9f3a-2a3b4c5d6e7f"
                        senderId: "2a7b158f-4e3b-4f2a-9b4a-3d5c6e7f8g9h"
                        content: "Привет!"
                        sentAt: "2024-06-01T12:00:00Z"
                    meta:
                      nextCursor: "eyJpZCI6IjM0NTY3OGZiZjY0In0="
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

    post:
      operationId: sendChatMessage
      summary: "Отправить сообщение в чат"
      description: "Отправляет сообщение в чат."
      parameters:
        - $ref: "./shared/parameters.yaml#/chatId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
              required: [content]
      responses:
        "201":
          description: Сообщение отправлено
          content:
            application/json:
              schema:
                $ref: "./models/Message.yaml#/Message"
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /chats/{chatId}/read:
    post:
      operationId: markChatAsRead
      summary: "Отметить чат как прочитанный"
      description: "Отмечает чат как прочитанный."
      parameters:
        - $ref: "./shared/parameters.yaml#/chatId"
      responses:
        "204":
          description: Чат отмечен как прочитанный
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "403":
          $ref: "./shared/responses.yaml#/Forbidden"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /notifications:
    get:
      operationId: getNotifications
      summary: "Получить уведомления"
      description: "Возвращает список уведомлений пользователя с пагинацией."
      parameters:
        - $ref: "./shared/parameters.yaml#/limit"
        - $ref: "./shared/parameters.yaml#/cursor"
      responses:
        "200":
          description: Список уведомлений
          content:
            application/json:
              schema:
                $ref: "./models/PaginatedNotifications.yaml#/PaginatedNotifications"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /notifications/{id}/read:
    post:
      operationId: markNotificationAsRead
      summary: "Отметить уведомление как прочитанное"
      description: "Отмечает уведомление как прочитанное."
      parameters:
        - $ref: "./shared/parameters.yaml#/notificationId"
      responses:
        "204":
          description: Уведомление отмечено как прочитанное
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"
        "404":
          $ref: "./shared/responses.yaml#/NotFound"

  /devices/push-token:
    post:
      operationId: addPushToken
      summary: "Добавить push-токен устройства"
      description: "Регистрирует push-токен устройства для уведомлений."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
                platform:
                  type: string
                  enum: [ios, android]
              required: [token, platform]
      responses:
        "204":
          description: Токен добавлен
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

    delete:
      operationId: deletePushToken
      summary: "Удалить push-токен устройства"
      description: "Удаляет push-токен устройства."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
              required: [token]
      responses:
        "204":
          description: Токен удален
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

  /media/upload:
    post:
      operationId: uploadMedia
      summary: "Загрузить медиафайл"
      description: "Загружает файл с указанием назначения (post, chat, event, club)."
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                purpose:
                  type: string
                  enum: [post, chat, event, club]
              required: [file, purpose]
      responses:
        "201":
          description: Файл загружен
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    format: uri
        "400":
          $ref: "./shared/responses.yaml#/BadRequest"
        "401":
          $ref: "./shared/responses.yaml#/Unauthorized"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
